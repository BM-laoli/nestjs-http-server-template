# å¦‚ä½•åœ¨Mainä¸­è·å–ä¸Šä¸‹æ–‡?
>
> æœ‰æ—¶å€™æˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿå“Main ä¸­è·å–AppModule çš„ä¸Šä¸‹æ–‡ï¼Œä¸ºæ­¤ä½ å¯ä»¥è¿™æ ·å†™

```ts
const app = await NestFactory.createApplicationContext(AppModule);
// å¦‚æœä½ æƒ³è·å– AppModule ä¸Šä¸‹æ–‡ å¯ä»¥ç›´æ¥ ï¼ˆæ³¨æ„æˆ‘ä»¬çœ‹ä¸‹é¢çš„ä¾‹å­ ConfigServiceæ˜¯ åœ¨AppModule ä»¥åŠæ³¨å†Œè¿‡çš„ï¼‰
const configService = app.get(ConfigService) as ConfigService;

const tasksService = app.select(TasksModule).get(TasksService, { strict: true });

```

# å…³äºCLI
>
> æˆ‘ä»¬ä»ä¸€å¼€å§‹éƒ½å…¨éƒ¨éƒ½çˆ±ä½¿ç”¨ Nestæä¾›çš„CLI ä¸ç®¡æ˜¯åˆ›å»ºé¡¹ç›®éª¨æ¶è¿˜æ˜¯å„ä¸ªæ¨¡å—éƒ½æ˜¯ç”¨çš„å®ƒï¼Œå®é™…ä¸Šä½ å¯ä»¥å•ç‹¬çš„ä½¿ç”¨ nestä¸ä¸€å®šéœ€è¦ä½¿ç”¨ä»–çš„ CLIï¼Œä¸»è¦è¿˜æ˜¯çœ‹ å®é™…çš„éœ€æ±‚ï¼Œåœ¨Newegg æˆ‘ä»¬æ›´å¤šçš„å¹¶ä¸æ˜¯ä¾èµ–Nestçš„CLI .

> ä»ä¾¿åˆ©ç¨‹åº¦æ¥çœ‹ ä½¿ç”¨Nest CLI æ•ˆç‡æ˜¯æœ‰ä¸€å®šæå‡çš„ï¼Œç‰¹åˆ«æ˜¯å¯¹äºä¸€èˆ¬çš„éœ€æ±‚è€Œè¨€

## ç®€å•çš„äº†è§£ä¸€ä¸‹
>
> æˆ‘ä»¬çœ‹çœ‹ ç®€å•çš„ä¸€äº›å‘½ä»¤ (ng å³è§†æ„Ÿ)

### ç®€å•çš„ç”¨ä¸€ä¸‹

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ npx æˆ–è€… npm æˆ–è€… yarnå…¨å±€å®‰è£… è¿™ä¸ªCLI

```shell
$ npm install -g @nestjs/cli

# æŸ¥çœ‹å¸®åŠ©
$ nest --help

# ç”Ÿæˆå™¨ 
$ nest generate --help

# ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„åˆ›å»ºçš„æ¨¡æ¿é¡¹ç›®çš„å‘½ä»¤ (æ ‡å‡†æ¨¡å¼)
$ nest new my-nest-project
```

### å…³äºå·¥ç¨‹ç»“æ„å’Œè®¾è®¡

å…³äºé¡¹ç›®çš„å·¥ç¨‹ç»“æ„ï¼Œä¸€èˆ¬è€Œè¨€ nest new æˆ‘ä»¬ä»…é¢å¯¹çš„æ˜¯ ä¸€ä¸ª â€œæ ‡å‡†å·¥ç¨‹â€ï¼Œä¸è¿‡Nest CLI è¿˜ææ”¯æŒå…¶ä»–çš„å·¥ç¨‹ç®¡ç†æ¨¡å¼ï¼Œæ¯”å¦‚  *Multiple projects* *Libåº“* ä»–ä»¬æ˜¯ç”¨å¤§å¤šæ•°æƒ…å†µä¸‹ä½¿ç”¨ monorepoæ¥ç®¡ç†çš„ã€‚

ä¸‹é¢æ˜¯ä¸€äº›æ‘˜è¦, æˆ‘ä»¬å±•ç¤ºäº†ä¸åŒå·¥ç¨‹ç®¡ç†æ¨¡å¼ä¸‹çš„ å¼‚åŒ

|  å·¥ç¨‹è®¾ç½®  | æ ‡å‡†æ¨¡å¼ | Monorepoæ¨¡å¼ |
| ---- | ---- | ---- |
|  Multiple projects  | åˆ†å¼€æ–‡ä»¶ç³»ç»Ÿç»“æ„ | å•ä¸ªæ–‡ä»¶ç³»ç»Ÿç»“æ„ |
|  node_modules & package.json  | å•ç‹¬çš„å®ä¾‹  | å¯ä»¥å…è®¸éƒ¨åˆ†ä¾èµ–äº’ç›¸å¼•ç”¨å’Œæ¨¡å—å…±äº«  |
|  é»˜è®¤çš„ç¼–è¯‘å™¨  | tsc | webpack |
|  ç¼–è¯‘è®¾ç½®  | å•ç‹¬æŒ‡å®š | æ¯ä¸ªé¡¹ç›®å¯ä»¥è‡ªå®šä¹‰  |
|  Config files like , , etc..eslintrc.js.prettierrc  | å•ç‹¬æŒ‡å®š | æ¯ä¸ªé¡¹ç›®å¯ä»¥è‡ªå®šä¹‰ |
|  nest build and commandsnest start  | ç›®æ ‡è‡ªåŠ¨é»˜è®¤ä¸ºä¸Šä¸‹æ–‡ä¸­çš„ï¼ˆä»…ï¼‰é¡¹ç›® | ç›®æ ‡é»˜è®¤ä¸ºå•å­˜å‚¨åº“ä¸­çš„é»˜è®¤é¡¹ç›® |
|  Libraries  | æ‰‹åŠ¨ç®¡ç†ï¼Œé€šå¸¸é€šè¿‡ npm æ‰“åŒ… å†…ç½®æ”¯æŒ | å†…ç½®æ”¯æŒï¼ŒåŒ…æ‹¬è·¯å¾„ç®¡ç†å’ŒBundle |

çœ‹èµ·æ¥æœ‰ç‚¹è¿·ç³Šæˆ‘ä»¬ä¸€ä¼šå„¿å®é™…ä¸Šæ¥çœ‹çœ‹å°±æ™“å¾—äº†

### CLIçš„ä¸€äº›åŸºæœ¬çš„æŒ‡ä»¤

```shell
# å¤§éƒ¨åˆ†æƒ…å†µä¸‹ éƒ½éµå¾ªä¸‹é¢çš„ ğŸ‘‡çš„è§„èŒƒ
$ nest commandOrAlias requiredArg [optionalArg] [options]

# æ¯”å¦‚è¿™ä¸ª è¡¨ç¤ºåˆ›å»ºé¡¹ç›® ç„¶åå»runä¸€ä¸‹ 
$ nest new my-nest-project --dry-run

# æˆ‘ä»¬è¿˜æœ‰ä¸€äº›ç¼©å†™å½¢å¼ æ¯”å¦‚
$ nest n my-nest-project -d

# å¦‚æœä½ ä¸çŸ¥é“ æŸä¸ªå‘½ä»¤çš„åˆ«å è¯·ä½¿ç”¨ 
$ nest new --help

```

## WorkSpace
>
> æœ¬å°èŠ‚æˆ‘ä»¬æ¥ åˆ†æä¸€ä¸‹ Nestjs çš„ CLIç”Ÿæˆçš„é¡¹ç›®çš„éª¨æ¶ çš„è¿™äº›ç›®å½•å’Œå…¶å…·ä½“ä½œç”¨ï¼Œä»¥åŠmono repoæ¨¡å¼ä¸‹ä¸‹çš„å·¥ç¨‹ç»“æ„å’Œå…¶è¯´æ˜

### æ¦‚è¿°

ä¸€èˆ¬è€Œè¨€åœ¨Nestä¸­æˆ‘ä»¬æœ‰ä¸¤ç§æ¨¡å¼æ¥ç»„ç»‡ä»£ç  ( æ ‡å‡†æ¨¡å¼ å’Œ mono repoæ¨¡å¼ ), æ‰€è°“çš„æ ‡å‡†æ¨¡å¼ å°±æ˜¯Nest CLI ç›´æ¥New çš„é‚£ç§ï¼Œæ¯”è¾ƒé€‚åˆå°å‹é¡¹ç›®ã€‚mono repoæ¨¡å¼é—®å°±ä¸è¯¦ç»†è®²äº†ï¼ŒNest CLI æä¾›äº† ä½¿ç”¨CLI å‘½ä»¤ç›´æ¥ç”Ÿæˆmonorepo ç»“æ„çš„æŒ‡ä»¤å¾ˆæ–¹ä¾¿ï¼Œé€‚åˆç›¸å¯¹å¤æ‚çš„é¡¹ç›®ã€‚

### monorepoæ¨¡å¼

æˆ‘ä»¬éœ€è¦æŒ‰ç…§ä¸‹é¢çš„æ­¥éª¤ä¸€æ­¥ä¸€æ­¥ çš„ç”Ÿæˆè¿™æ ·çš„é¡¹ç›®ç»“æ„

```shell
# å…ˆç”Ÿæˆ æ ‡å‡†æ¨¡å¼é¡¹ç›®( è¿™æ ·ä½ å°†ä¼šå¾—åˆ°ä¸€ä¸ªå®Œæ•´çš„æ ‡å‡†Nesté¡¹ç›®éª¨æ¶ )
$ nest new project
$ cd ./project

# ç„¶åç”¨ CLI å»ç”Ÿå­˜ mono repo éœ€è¦çš„å­é¡¹ç›®
$ nest generate app my-app
```

è¿™æ ·å°±ä¼šç”Ÿæˆä¸€ä¸ª monorepo çš„é¡¹ç›®å®ƒçš„ç»“æ„å°†ä¼šæ˜¯ä¸‹é¢çš„è¿™æ ·æ ·å­

```shell
â”œâ”€â”€ README.md
â”œâ”€â”€ apps
â”‚Â Â  â”œâ”€â”€ app1
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ src
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ app1.controller.spec.ts
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ app1.controller.ts
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ app1.module.ts
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ app1.service.ts
â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ main.ts
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ test
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ app.e2e-spec.ts
â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ jest-e2e.json
â”‚Â Â  â”‚Â Â  â””â”€â”€ tsconfig.app.json
â”‚Â Â  â”œâ”€â”€ app2
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ src
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ app2.controller.spec.ts
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ app2.controller.ts
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ app2.module.ts
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ app2.service.ts
â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ main.ts
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ test
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ app.e2e-spec.ts
â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ jest-e2e.json
â”‚Â Â  â”‚Â Â  â””â”€â”€ tsconfig.app.json
â”‚Â Â  â””â”€â”€ nestjs-http-server-template
â”‚Â Â      â”œâ”€â”€ src
â”‚Â Â      â”‚Â Â  â”œâ”€â”€ app.controller.ts
â”‚Â Â      â”‚Â Â  â”œâ”€â”€ app.module.ts
â”‚Â Â      â”‚Â Â  â”œâ”€â”€ app.service.ts
â”‚Â Â      â”‚Â Â  â””â”€â”€ main.ts
â”‚Â Â      â”œâ”€â”€ test
â”‚Â Â      â”‚Â Â  â”œâ”€â”€ app.e2e-spec.ts
â”‚Â Â      â”‚Â Â  â””â”€â”€ jest-e2e.json
â”‚Â Â      â””â”€â”€ tsconfig.app.json
â”œâ”€â”€ nest-cli.json
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.build.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ yarn.lock
```

ç”Ÿæˆå®Œè¿™æ ·çš„é¡¹ç›®ä¹‹å å®ƒä¼š å¾€ nest-cli.json é‡Œé¢å†™é…ç½®ï¼Œä»¥ä¾›nest cli å†run çš„æ—¶å€™å»è¯»å–å®ƒ
nest-cli.json

```json
{
  "collection": "@nestjs/schematics",
  "sourceRoot": "apps/nestjs-http-server-template/src",
  "monorepo": true,
  "root": "apps/nestjs-http-server-template",
  "compilerOptions": {
    "webpack": true,
    "tsConfigPath": "apps/nestjs-http-server-template/tsconfig.app.json"
  },
  "projects": {
    "nestjs-http-server-template": {
      "type": "application",
      "root": "apps/nestjs-http-server-template",
      "entryFile": "main",
      "sourceRoot": "apps/nestjs-http-server-template/src",
      "compilerOptions": {
        "tsConfigPath": "apps/nestjs-http-server-template/tsconfig.app.json"
      }
    },
    "app1": {
      "type": "application",
      "root": "apps/app1",
      "entryFile": "main",
      "sourceRoot": "apps/app1/src",
      "compilerOptions": {
        "tsConfigPath": "apps/app1/tsconfig.app.json"
      }
    },
    "app2": {
      "type": "application",
      "root": "apps/app2",
      "entryFile": "main",
      "sourceRoot": "apps/app2/src",
      "compilerOptions": {
        "tsConfigPath": "apps/app2/tsconfig.app.json"
      }
    }
  }
}
```

```shell
# æ¥ä¸‹æ¥è¿™æ ·run å°±ok (æ³¨æ„è¦åœ¨å·¥ç¨‹çš„root ç›®å½•)
$ yarn start app2
$ yarn start app1

```

æ¥ä¸‹æ¥æˆ‘ä»¬ç ”ç©¶ä¸€ä¸‹ è¿™ä¸ª nest-cli.json çš„é…ç½®åˆ°åº•æ˜¯å¹²ä»€ä¹ˆç”¨çš„

### ç ”ç©¶ä¸€ä¸‹è¿™ä¸ª JSON

è¿˜æ˜¯çœ‹è¿™ä»½JSON æ–‡ä»¶ï¼Œå®ƒåˆ†ä¸ºäº†ä¸¤ä¸ªéƒ¨åˆ†

1. é¡¹ç›®é¡¶çº§çš„å…¨å±€çš„ï¼Œç”¨æ¥æ§åˆ¶æ ‡å‡†é¡¹ç›®/å•å·¥ç¨‹çš„é…ç½®

2. å­projectçš„å•ç‹¬çš„é…ç½®

ä¸ç®¡æ˜¯é¡¹ç›®çº§åˆ«çš„è¿˜æ˜¯ å…¨å±€çº§åˆ«çš„ï¼Œ å¤§éƒ¨åˆ†çš„é…ç½®é¡¹éƒ½å¤§åŒå°å¼‚ï¼Œç°åœ¨æˆ‘ä»¬é¦–å…ˆè¯´è¯´
**å…¨å±€æ€§çš„é…ç½®é¡¹ç›®**
"collection"ï¼šæŒ‡å‘ç”¨äºç”Ÿæˆå…ƒä»¶çš„åŸç†å›¾é›†åˆ;é€šå¸¸ä¸åº”æ›´æ”¹æ­¤å€¼
"sourceRoot"ï¼šæŒ‡å‘æ ‡å‡†æ¨¡å¼ç»“æ„ä¸­å•ä¸ªé¡¹ç›®çš„æºä»£ç æ ¹ï¼Œæˆ–å•å­˜å‚¨åº“æ¨¡å¼ç»“æ„ä¸­é»˜è®¤é¡¹ç›®çš„æºä»£ç æ ¹ç›®å½•
"compilerOptions"ï¼šå¸¦æœ‰æŒ‡å®šç¼–è¯‘å™¨é€‰é¡¹çš„é”®å’ŒæŒ‡å®šé€‰é¡¹è®¾ç½®çš„å€¼çš„æ˜ å°„;è¯·å‚é˜…ä¸‹é¢çš„è¯¦ç»†ä¿¡æ¯
"generateOptions"ï¼šå¸¦æœ‰æŒ‡å®šå…¨å±€ç”Ÿæˆé€‰é¡¹çš„é”®å’ŒæŒ‡å®šé€‰é¡¹è®¾ç½®çš„å€¼çš„æ˜ å°„;è¯·å‚é˜…ä¸‹é¢çš„è¯¦ç»†ä¿¡æ¯
"monorepo"ï¼šï¼ˆä»…é™å•å­˜å‚¨åº“ï¼‰å¯¹äºå•å­˜å‚¨åº“æ¨¡å¼ç»“æ„ï¼Œæ­¤å€¼å§‹ç»ˆä¸ºtrue
"root"ï¼šï¼ˆä»…é™ monorepoï¼‰æŒ‡å‘é»˜è®¤é¡¹ç›®çš„é¡¹ç›®æ ¹ç›®å½•

ä»–ä»¬åœ¨ json ä¸­å°±æ˜¯è¿™æ®µé…ç½®

```json
{
  "collection": "@nestjs/schematics",
  "sourceRoot": "apps/nestjs-http-server-template/src",
  "monorepo": true,
  "root": "apps/nestjs-http-server-template",
  "compilerOptions": {
    "webpack": true,
    "tsConfigPath": "apps/nestjs-http-server-template/tsconfig.app.json"
  },
  "projects": {}
}
```

æ¥ä¸‹æ¥æˆ‘ä»¬è¿›è¡Œ æ›´åŠ è¯¦ç»†çš„æ‹†è§£
*ç¼–è¯‘å™¨é…ç½®*
æ³¨æ„å•Š è¿™é‡ŒæŒ‡çš„å°±æ˜¯ compilerOptions

å®ƒåœ¨JSONä¸­å°±æ˜¯è¿™ä¸ªé…ç½®

```json
  ++++
  "compilerOptions": {
    "webpack": true,
    "tsConfigPath": "apps/nestjs-http-server-template/tsconfig.app.json"
  },
  "projects": {
    ++++
```

å®ƒçš„å¯é€‰é¡¹ å’Œå…·ä½“ä½œç”¨ è§ä¸‹è¡¨

| å±æ€§ | ç±»å‹ | æè¿° |
| --- | --- | --- |
| webpack | å¸ƒå°” | å¦‚æœ ï¼Œè¯·ä½¿ç”¨ webpack ç¼–è¯‘å™¨ã€‚å¦‚æœä¸å­˜åœ¨ï¼Œè¯·ä½¿ç”¨ ã€‚åœ¨å•å­˜å‚¨åº“æ¨¡å¼ä¸‹ï¼Œé»˜è®¤å€¼ä¸º ï¼ˆä½¿ç”¨ webpackï¼‰ï¼Œåœ¨æ ‡å‡†æ¨¡å¼ä¸‹ï¼Œé»˜è®¤å€¼ä¸º ï¼ˆä½¿ç”¨ ï¼‰ã€‚è¯¦æƒ…è§ä¸‹æ–‡ã€‚truefalsetsctruefalsetsc |
| tsConfigPath | å­—ç¬¦ä¸² | (ä»…é™å•å­˜å‚¨åº“ï¼‰æŒ‡å‘åŒ…å«å°†åœ¨è°ƒç”¨æ—¶ä½¿ç”¨çš„è®¾ç½®çš„æ–‡ä»¶ï¼ˆä¾‹å¦‚ï¼Œåœ¨ç”Ÿæˆæˆ–å¯åŠ¨é»˜è®¤é¡¹ç›®æ—¶ï¼‰ã€‚tsconfig.jsonnest buildnest startproject |
| webpackConfigPath | å­—ç¬¦ä¸² | æŒ‡å‘ webpack é€‰é¡¹æ–‡ä»¶ã€‚å¦‚æœæœªæŒ‡å®šï¼ŒNest å°†æŸ¥æ‰¾è¯¥æ–‡ä»¶ã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ä¸‹æ–‡ã€‚webpack.config.js |
| deleteOutDir | å¸ƒå°” | å¦‚æœ ï¼Œæ— è®ºä½•æ—¶è°ƒç”¨ç¼–è¯‘å™¨ï¼Œå®ƒéƒ½ä¼šé¦–å…ˆåˆ é™¤ç¼–è¯‘è¾“å‡ºç›®å½•ï¼ˆå¦‚ ä¸­é…ç½®çš„é‚£æ ·ï¼Œå…¶ä¸­é»˜è®¤å€¼ä¸º ï¼‰ã€‚truetsconfig.json./dist |
| assets | æ•°ç»„ | å…è®¸åœ¨ç¼–è¯‘æ­¥éª¤å¼€å§‹æ—¶è‡ªåŠ¨åˆ†å‘é TypeScript èµ„äº§ï¼ˆåœ¨æ¨¡å¼ä¸‹çš„å¢é‡ç¼–è¯‘ä¸­ä¸ä¼šå‘ç”Ÿèµ„äº§åˆ†å‘ï¼‰ã€‚è¯¦æƒ…è§ä¸‹æ–‡ã€‚--watch |
| watchAssets | å¸ƒå°” | å¦‚æœ ï¼Œåˆ™åœ¨ç›‘è§†æ¨¡å¼ä¸‹è¿è¡Œï¼Œç›‘è§†æ‰€æœ‰é TypeScript èµ„æºã€‚ï¼ˆæœ‰å…³è¦ç›‘è§†çš„èµ„äº§çš„æ›´ç²¾ç»†æ§åˆ¶ï¼Œè¯·å‚é˜…ä¸‹é¢çš„èµ„äº§éƒ¨åˆ†ï¼‰ã€‚true |
| manualRestart | å¸ƒå°” | å¦‚æœä¸º ï¼Œåˆ™å¯ç”¨æ‰‹åŠ¨é‡æ–°å¯åŠ¨æœåŠ¡å™¨çš„å¿«æ·æ–¹å¼ã€‚é»˜è®¤å€¼ä¸º ã€‚truersfalse |

*ç”Ÿæˆå™¨é…ç½®generate*

æœ‰çš„æ—¶å€™æˆ‘ä»¬ç»å¸¸ä¼šä½¿ç”¨ nest çš„cli è¿›è¡Œ generate æ“ä½œæ¯”å¦‚ generate controller / service / moduleï¼Œ å®ƒä¹Ÿå¯ä»¥é€šè¿‡ nest-cli.json è¿›è¡Œé…ç½®

```json
"generateOptions": {
    // "spec": false  å…¨å±€éƒ½ç¦æ­¢ 
    "spec": {
      "service": false // é’ˆå¯¹æŸä¸€ç±» 
    }
  },
// å½“ç„¶è¿™ä¸ª generateOptions æ—¢å¯ä»¥ æ–¹åœ¨å…¨å±€ ä¹Ÿå¯ä»¥æ”¾åˆ° å­é¡¹ç›®ä¸­å»
```

*æŒ‡å®šç¼–è¯‘å™¨*

ä¸€èˆ¬æƒ…å†µä¸‹ï¼ˆæ ‡å‡†å·¥ç¨‹ï¼‰éƒ½æ˜¯ç”¨webpack è¿›è¡Œç¼–è¯‘çš„ï¼Œå¦‚æœæˆ‘ä»¬ä¸å¸Œæœ›webpack è¿›è¡Œç¼–è¯‘ï¼Œå¯ä»¥ç»™ä¸€ä¸ªfalse ï¼Œè¿™æ ·å®ƒå°±ä¼šåˆ‡åˆ° tsc  è¿›è¡Œç¼–è¯‘.

```json
"compilerOptions": {
    "webpack": true,
    .....
}
```

*webpacké…ç½®*

å¦‚æœä½ å¸Œæœ›è‡ªå·±å¯ä»¥é…ç½® é‚£ä¹ˆå¯ä»¥åœ¨æ ¹ç›®å½•ä¸‹ å†™å…·ä½“çš„é…ç½®

```js
~ webpack.config.js
module.exports = function (options) {
  return {
    ...options,
    externals: [],
  };
};
èµ„äº§
```

*assets é…ç½®*
æˆ‘ä»¬å¯ä»¥é…ç½® assets ï¼ˆéts ï¼‰æ–‡ä»¶ æ„å»ºæ–¹å¼ï¼Œæ¯”å¦‚ cv åˆ° é¡¹ç›®root ç›®å½•ä¸‹çš„doc ä¸‹å»

```ts
 "app2": {
      "type": "application",
      "root": "apps/app2",
      "entryFile": "main",
      "sourceRoot": "apps/app2/src",
      "compilerOptions": {
        "tsConfigPath": "apps/app2/tsconfig.app.json",
        "assets": [
          {  
            "include": "static/**/*", 
             "outDir":"./doc/",
             "watchAssets": true 
          }
        ]
      }
    }
```

## Libraries
>
> åˆšæ‰æˆ‘ä»¬çœ‹çš„å¤§å¤šæ•°æ˜¯ monorepo çš„app (æˆ‘çš„æ„æ€æ˜¯ apps ä¸‹éƒ½æ˜¯ ç±»ä¼¼çš„ç»“æ„æ ‡å‡†Nest å·¥ç¨‹éª¨æ¶)ï¼Œä¸€èˆ¬è€Œè¨€å°±èŒè¿‡è§„æ¨¡æ¯”è¾ƒå¤§çš„å…¬å¸ï¼Œå¯¹äºTOCçš„é¡¹ç›® ä¼šç›¸å¯¹æ›´å¤ç‚¸ä¸€äº› ï¼Œå¾€å¾€ä¼šä½¿ç”¨git submodule + learn ä¹‹ç±»çš„å·¥ä½œæ¥ç®¡ç†ï¼ŒæŠŠ é€šç”¨çš„ æ–—å½’ç±»åˆ° æŸä¸ª å…±ç”¨åº“å»ã€‚ è€Œè¿™ä¸ªå…±æœ‰çš„åº“ï¼Œå¯ä»¥å‘å¸ƒåˆ° å…¬å¸çš„npm ç§æœ‰åŸŸä¸‹ï¼Œå…¨å…¬å¸ éƒ½å¯ä»¥å…±äº«ï¼Œåœ¨å¤§è§„æ¨¡åä½œä¸­ï¼Œè¿™ç§æ–¹å¼è¿˜æ˜¯éå¸¸çš„é«˜æ•ˆçš„. æ¯”å¦‚æˆ‘æ‰€åœ¨çš„Newegg å°±æ˜¯è¿™æ ·çš„æ¨¡å¼.
>
> åœ¨Nest ä¸­ã€‚é»˜è®¤å°±æä¾›æ¥äº†æ„å»ºè¿™ç§æ¨¡å¼çš„ cli ç¨‹åºï¼Œååˆ†çš„æ–¹ä¾¿

```shell
$ nest g library my-library
What prefix would you like to use for the library (default: @app)?

# è¿™æ ·å°±å¥½äº† ä½¿ç”¨çš„ä½¿ç”¨ åªéœ€è¦ @app/xxxx, @app/xxxx
â”œâ”€â”€ libs
â”‚Â Â  â””â”€â”€ app
â”‚Â Â      â”œâ”€â”€ src
â”‚Â Â      â”‚Â Â  â”œâ”€â”€ app.module.ts
â”‚Â Â      â”‚Â Â  â”œâ”€â”€ app.service.spec.ts
â”‚Â Â      â”‚Â Â  â”œâ”€â”€ app.service.ts
â”‚Â Â      â”‚Â Â  â””â”€â”€ index.ts
â”‚Â Â      â””â”€â”€ tsconfig.lib.json
â”œâ”€â”€ nest-cli.json
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.build.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ yarn.lock
```

ç„¶åå®ƒçš„é…ç½® å’Œå¤§åŒ…ä»€ä¹ˆçš„ï¼Œéƒ½ä¼šç»Ÿä¸€çš„åŠ åˆ° nest-cli.jsonä¸­

```json
"project": {
  +++
 "app": {
      "type": "library",
      "root": "libs/app",
      "entryFile": "index",
      "sourceRoot": "libs/app/src",
      "compilerOptions": {
        "tsConfigPath": "libs/app/tsconfig.lib.json"
      }
    }
}

```

 å¯¹äºtsconfig çš„é…ç½® ä¹Ÿä¼šä¸€èµ·è‡ªåŠ¨æ›´æ–°æ‰

 ```ts
 ~ tsconfig.json
    "paths": {
      "@app/app": [
        "libs/app/src"
      ],
      "@app/app/*": [
        "libs/app/src/*"
      ]
    }
  }
}
 ```

 æ¯”å¦‚ æˆ‘ç°åœ¨ åœ¨App2 ä¸­ä½¿ç”¨å®ƒ æˆ‘åœ¨ libä¸‹å®šä¹‰çš„å·¥å…·

 ```ts
 ~ libs/app

 // éšæœºç”Ÿæˆä¸€æ®µæ–‡å­—
export function randomText() {
  return Math.random().toString(36).substring(2);
}

~ app2 ä¸­ä½¿ç”¨
import { randomText } from '@app/app';
@Controller()
export class App2Controller {
  constructor(private readonly app2Service: App2Service) {}

  @Get()
  getHello(): string {
    return randomText();
  }
}

 ```

ç›´æ¥å»run app2 å°±èƒ½çœ‹å¾—å€’æ•ˆæœ

```shell
yarn start:dev app2
```

ä½†æ˜¯æ›´é‡è¦çš„ä¸€ç‚¹çš„æ˜¯: æ‰“åŒ…çš„æ—¶å€™ä¼šæœ‰ç‚¹å¥‡æ€ª ä»–ç”Ÿæˆçš„ç›®å½•ç»“æ„æ˜¯è¿™æ ·çš„

```
- dist
  apps
      â””â”€â”€ app2
          â”œâ”€â”€ apps
          â”‚Â Â  â””â”€â”€ app2
          â”‚Â Â      â””â”€â”€ src
          â”‚Â Â          â”œâ”€â”€ app2.controller.js
          â”‚Â Â          â”œâ”€â”€ app2.controller.js.map
          â”‚Â Â          â”œâ”€â”€ app2.module.js
          â”‚Â Â          â”œâ”€â”€ app2.module.js.map
          â”‚Â Â          â”œâ”€â”€ app2.service.js
          â”‚Â Â          â”œâ”€â”€ app2.service.js.map
          â”‚Â Â          â”œâ”€â”€ main.js
          â”‚Â Â          â””â”€â”€ main.js.map
          â”œâ”€â”€ libs
          â”‚Â Â  â””â”€â”€ app
          â”‚Â Â      â””â”€â”€ src
          â”‚Â Â          â”œâ”€â”€ index.js
          â”‚Â Â          â”œâ”€â”€ index.js.map
          â”‚Â Â          â””â”€â”€ service
          â”‚Â Â              â”œâ”€â”€ index.js
          â”‚Â Â              â””â”€â”€ index.js.map
          â””â”€â”€ tsconfig.app.tsbuildinfo
```

# 微服务

## 基础介绍（多个NestJS 程序之间的调用

> 介绍一下 多个Nest程序之间的调用方式 和实现
> 为了演示 功能，我们需要调整一下 程序，把它变成一个 monorepo 工程
> 具体到底如何 基于other_tech 我们新 拉一个分支 命名为 monorepo , 具体的集成方法 请参考为的 另一个 github参考 哪里有文章和例子 <https://github.com/BM-laoli/morerepo-test> (有可能learn 这种方式已经过时，请参考 )<https://juejin.cn/post/6964328103447363614#comment> 来做pnpm下的 monorepo
>

## Pnpm下的monorepo工程改造
>
> 参考文章 <https://juejin.cn/post/6964328103447363614#comment>
>
> 注意 以下内容 ，请不要直接拿去用，我仅仅做了演示为了图方便，在nest中如果你要实施 monorepo  请看 nest官方文档，官方文档提供了 一个适用 与Nest的方案 <https://docs.nestjs.com/cli/monorepo>. 当然你如果 想一意孤行 ，那么 哈哈哈 请参考下面的文档

1. 新建文件夹 (子项目)

packages/m1 这个文件夹下📁 下就有一个新的Nestjs 项目了

```shell
├── src
│   ├── app.controller.ts
│   ├── app.module.ts
│   ├── app.service.ts
│   └── main.ts
├── package.json
├── nest-cli.json
├── tsconfig.build.json
├── tsconfig.json
└── yarn.lock

```

注意改一下去掉 private，如果你需要 请改一下包名（大部分情况下 你并不需要去改 因为我们是两个 独立的 service, 除非你要做 lib，若做lib Nest官方也有详细说明

```json
{
  "name": "nest-m1",
  "version": "1.0.0",
  "description": "Nest TypeScript starter repository",
  "license": "MIT",
  // 去掉 "private": true,
}
```

2. pnpm 初始化

```shell
# 初始化
$ pnpm init -y
```

新建一个 pnpm-workspace.yaml

```yaml
packages:
  # all packages in subdirs of packages/ and components/
  - 'packages/**'

```

3. 依赖安装

```shell
# root 目录(我们原来从 另一个branch 过来的 一样install就好了，既得install 前 把 node_mmodules 先干掉 )
$ pnpm install -w  # (意思是全局依赖)

# package/m1 目录
$ pnpm install 
```

这样就算搞定了！

### Install

### 注入和初始化

### Service 端

### Client 端

## 集成其它的工具🔧

### Redis

### MQTT

### NATS

### RabbitMQ

### Kafka

### gRPC

## 关于其它的操作

### 自定义传输器

### 有关Error的操作

### Pip

### Guard

### Interceptors
